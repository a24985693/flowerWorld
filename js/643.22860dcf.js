(self["webpackChunkfinal_hw"]=self["webpackChunkfinal_hw"]||[]).push([[643],{8647:function(e,t,s){
/*!
  * Bootstrap collapse.js v5.3.3 (https://getbootstrap.com/)
  * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */
(function(t,i){e.exports=i(s(9011),s(7956),s(5411),s(4035))})(0,(function(e,t,s,i){"use strict";const o="collapse",l="bs.collapse",r=`.${l}`,n=".data-api",a=`show${r}`,c=`shown${r}`,d=`hide${r}`,h=`hidden${r}`,u=`click${r}${n}`,g="show",p="collapse",m="collapsing",f="collapsed",L=`:scope .${p} .${p}`,k="collapse-horizontal",_="width",v="height",b=".collapse.show, .collapse.collapsing",y='[data-bs-toggle="collapse"]',w={parent:null,toggle:!0},C={parent:"(null|element)",toggle:"boolean"};class x extends e{constructor(e,t){super(e,t),this._isTransitioning=!1,this._triggerArray=[];const i=s.find(y);for(const o of i){const e=s.getSelectorFromElement(o),t=s.find(e).filter((e=>e===this._element));null!==e&&t.length&&this._triggerArray.push(o)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return w}static get DefaultType(){return C}static get NAME(){return o}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(b).filter((e=>e!==this._element)).map((e=>x.getOrCreateInstance(e,{toggle:!1})))),e.length&&e[0]._isTransitioning)return;const s=t.trigger(this._element,a);if(s.defaultPrevented)return;for(const t of e)t.hide();const i=this._getDimension();this._element.classList.remove(p),this._element.classList.add(m),this._element.style[i]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(m),this._element.classList.add(p,g),this._element.style[i]="",t.trigger(this._element,c)},l=i[0].toUpperCase()+i.slice(1),r=`scroll${l}`;this._queueCallback(o,this._element,!0),this._element.style[i]=`${this._element[r]}px`}hide(){if(this._isTransitioning||!this._isShown())return;const e=t.trigger(this._element,d);if(e.defaultPrevented)return;const o=this._getDimension();this._element.style[o]=`${this._element.getBoundingClientRect()[o]}px`,i.reflow(this._element),this._element.classList.add(m),this._element.classList.remove(p,g);for(const t of this._triggerArray){const e=s.getElementFromSelector(t);e&&!this._isShown(e)&&this._addAriaAndCollapsedClass([t],!1)}this._isTransitioning=!0;const l=()=>{this._isTransitioning=!1,this._element.classList.remove(m),this._element.classList.add(p),t.trigger(this._element,h)};this._element.style[o]="",this._queueCallback(l,this._element,!0)}_isShown(e=this._element){return e.classList.contains(g)}_configAfterMerge(e){return e.toggle=Boolean(e.toggle),e.parent=i.getElement(e.parent),e}_getDimension(){return this._element.classList.contains(k)?_:v}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(y);for(const t of e){const e=s.getElementFromSelector(t);e&&this._addAriaAndCollapsedClass([t],this._isShown(e))}}_getFirstLevelChildren(e){const t=s.find(L,this._config.parent);return s.find(e,this._config.parent).filter((e=>!t.includes(e)))}_addAriaAndCollapsedClass(e,t){if(e.length)for(const s of e)s.classList.toggle(f,!t),s.setAttribute("aria-expanded",t)}static jQueryInterface(e){const t={};return"string"===typeof e&&/show|hide/.test(e)&&(t.toggle=!1),this.each((function(){const s=x.getOrCreateInstance(this,t);if("string"===typeof e){if("undefined"===typeof s[e])throw new TypeError(`No method named "${e}"`);s[e]()}}))}}return t.on(document,u,y,(function(e){("A"===e.target.tagName||e.delegateTarget&&"A"===e.delegateTarget.tagName)&&e.preventDefault();for(const t of s.getMultipleElementsFromSelector(this))x.getOrCreateInstance(t,{toggle:!1}).toggle()})),i.defineJQueryPlugin(x),x}))},3497:function(e,t,s){"use strict";s(4114);var i=s(4445),o=s(1250),l=s(9325),r=s(8465),n=s.n(r),a=s(9040);const c=(0,a.A)();t.A=(0,i.nY)("order",{state:()=>({couponCode:"",order:{user:{}},originalTotal:0,searchOrder:{},warning:"",isLoading:!1}),actions:{createOrder(e){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/api/cms67/order";o.A.post(t,{data:e}).then((e=>{this.isLoading=!1,l.A.push(`/checkout/${e.data.orderId}`)})).catch((()=>{this.isLoading=!1,c.pushMessage({style:"danger",title:"訂單建立失敗"})}))},confirmCreateOrder(e){n().fire({title:"確定表單資料",text:"表單送出後將不能修改訂單!",icon:"warning",cancelButtonText:"取消",confirmButtonText:"確定",showCancelButton:!0}).then((t=>{t.isConfirmed&&this.createOrder(e)}))},getOrder(e,t){if(this.isLoading=!0,e){const s=`https://vue3-course-api.hexschool.io/api/cms67/order/${e}`;o.A.get(s).then((e=>{if(this.isLoading=!1,e.data.order){t?this.searchOrder=e.data.order:this.order=e.data.order;const s=Object.keys(e.data.order.products)[0],i=e.data.order.products[s];i.coupon&&(this.couponCode=i.coupon.code)}else this.warning="訂單號碼輸入錯誤，請重新輸入";this.getOriginalTotal(e.data.order)})).catch((()=>{this.isLoading=!1,c.pushMessage({style:"danger",title:"訂單取得失敗"})}))}else this.isLoading=!1,this.warning="訂單號碼不可為空，請輸入訂單號碼"},getOriginalTotal(e){const t=Object.values(e.products).map((e=>e.total));this.originalTotal=0,t.forEach((e=>{this.originalTotal+=e}))},payOrder(){this.isLoading=!0;const e=`https://vue3-course-api.hexschool.io/api/cms67/pay/${this.order.id}`;o.A.post(e).then((e=>{if(this.isLoading=!1,e.data.success){this.getOrder(this.order.id);const e="付款成功";c.pushMessage({style:"success",title:e,content:"已完成付款"})}})).catch((()=>{this.isLoading=!1,c.pushMessage({style:"danger",title:"付款失敗"})}))},gotoPay(e){l.A.push(`/checkout/${e}`)}}})},1643:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return Ce}});var i=s(641),o=s(3751),l=s(33);const r={class:"page-title"},n=(0,i.Lk)("h2",null,"訂單查詢",-1),a={"aria-label":"breadcrumb"},c={class:"breadcrumb d-flex justify-content-center"},d={class:"breadcrumb-item"},h=(0,i.Lk)("li",{class:"breadcrumb-item active"}," 訂單查詢 ",-1),u={class:"container"},g={class:"row justify-content-center mb-5"},p={class:"col-12 col-md-7"},m=(0,i.Lk)("label",{for:"orderId",class:"d-none"},null,-1),f={class:"input-group"},L={key:0,class:"row flex-column-reverse justify-content-center align-items-center gy-5 gx-md-5"},k={class:"col-12 col-md-7"},_={class:"border border-2 border-info"},v=(0,i.Lk)("div",{class:"w-100 bg-info text-white fs-5 text-center py-2"}," 訂單明細 ",-1),b={class:"py-4 px-3"},y={class:"row border-bottom py-2"},w=(0,i.Lk)("div",{class:"col-12 col-sm-4 fw-semibold"},"訂單編號",-1),C={class:"col-12 col-sm-8"},x={class:"row border-bottom py-2"},O=(0,i.Lk)("div",{class:"col-12 col-sm-4 fw-semibold"},"Email",-1),A={class:"col-12 col-sm-8"},T={class:"row border-bottom py-2"},$=(0,i.Lk)("div",{class:"col-12 col-sm-4 fw-semibold"},"收件人姓名",-1),E={class:"col-12 col-sm-8"},I={class:"row border-bottom py-2"},S=(0,i.Lk)("div",{class:"col-12 col-sm-4 fw-semibold"},"收件人電話",-1),j={class:"col-12 col-sm-8"},F={class:"row border-bottom py-2"},P=(0,i.Lk)("div",{class:"col-12 col-sm-4 fw-semibold"},"收件人地址",-1),X={class:"col-12 col-sm-8"},M={class:"row border-bottom py-2"},N=(0,i.Lk)("div",{class:"col-12 col-sm-4 fw-semibold"},"留言",-1),D={class:"col-12 col-sm-8"},Q={class:"row border-bottom py-2"},B=(0,i.Lk)("div",{class:"col-12 col-sm-4 fw-semibold"},"付款狀態",-1),q={class:"col-12 col-sm-8"},z={key:0,class:"text-danger"},J={key:1,class:"text-success"},K={class:"row py-2 align-items-center"},U=(0,i.Lk)("div",{class:"col-8 fw-semibold"},"商品明細",-1),H={class:"col-4 fw-semibold text-end"},R={class:"collapse",id:"collapseProducts",ref:"collapseProducts"},V={class:"py-4"},W={class:"col-5"},Y={class:"col-2 text-center"},G={class:"col-5 text-end"},Z={class:"my-3"},ee={class:"d-flex justify-content-between mb-1"},te=(0,i.Lk)("p",null,"小計",-1),se={key:0,class:"text-muted d-flex justify-content-between mb-1"},ie=(0,i.Lk)("p",null,"折扣",-1),oe={key:1,class:"text-muted d-flex justify-content-between mb-1"},le=(0,i.Lk)("p",null,"已使用優惠券",-1),re=(0,i.Lk)("hr",null,null,-1),ne={class:"d-flex justify-content-between mb-3 fs-5 fw-medium"},ae=(0,i.Lk)("p",null,"總計",-1),ce={key:0,class:"mt-4"},de=(0,i.Lk)("i",{class:"fa-solid fa-triangle-exclamation me-2"},null,-1),he=(0,i.Lk)("span",{class:"fw-semibold"},"訂單尚未完成!",-1),ue=(0,i.Lk)("p",{class:"mb-3"},"確認訂單內容後，點擊付款即完成訂單!",-1),ge={class:"text-end"},pe={key:1},me={class:"h5 text-center text-danger"};function fe(e,t,s,fe,Le,ke){const _e=(0,i.g2)("LoadingSpinner"),ve=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)(i.FK,null,[(0,i.bF)(_e,{active:e.isLoading},null,8,["active"]),(0,i.Lk)("section",r,[n,(0,i.Lk)("nav",a,[(0,i.Lk)("ol",c,[(0,i.Lk)("li",d,[(0,i.bF)(ve,{to:"/",class:"text-decoration-none text-light"},{default:(0,i.k6)((()=>[(0,i.eW)(" 首頁 ")])),_:1})]),h])])]),(0,i.Lk)("div",u,[(0,i.Lk)("div",g,[(0,i.Lk)("div",p,[m,(0,i.Lk)("div",f,[(0,i.bo)((0,i.Lk)("input",{type:"text",class:"form-control rounded-0",id:"orderId",placeholder:"請輸入訂單號碼","onUpdate:modelValue":t[0]||(t[0]=e=>Le.orderId=e)},null,512),[[o.Jo,Le.orderId]]),(0,i.Lk)("button",{class:"btn btn-info",type:"button",onClick:t[1]||(t[1]=(...e)=>ke.sendSearchOrder&&ke.sendSearchOrder(...e))}," 查詢 ")])])]),null!==e.searchOrder&&e.searchOrder.id?((0,i.uX)(),(0,i.CE)("div",L,[(0,i.Lk)("div",k,[(0,i.Lk)("div",_,[v,(0,i.Lk)("div",b,[(0,i.Lk)("div",y,[w,(0,i.Lk)("div",C,(0,l.v_)(e.searchOrder.id),1)]),(0,i.Lk)("div",x,[O,(0,i.Lk)("div",A,(0,l.v_)(e.searchOrder.user.email),1)]),(0,i.Lk)("div",T,[$,(0,i.Lk)("div",E,(0,l.v_)(e.searchOrder.user.name),1)]),(0,i.Lk)("div",I,[S,(0,i.Lk)("div",j,(0,l.v_)(e.searchOrder.user.tel),1)]),(0,i.Lk)("div",F,[P,(0,i.Lk)("div",X,(0,l.v_)(e.searchOrder.user.address),1)]),(0,i.Lk)("div",M,[N,(0,i.Lk)("div",D,(0,l.v_)(e.searchOrder.message),1)]),(0,i.Lk)("div",Q,[B,(0,i.Lk)("div",q,[e.searchOrder.is_paid?((0,i.uX)(),(0,i.CE)("span",J,"付款完成")):((0,i.uX)(),(0,i.CE)("span",z,"尚未付款"))])]),(0,i.Lk)("div",K,[U,(0,i.Lk)("div",H,[(0,i.Lk)("button",{class:"btn btn-primary rounded-circle",type:"button","data-bs-toggle":"collapse","data-bs-target":"#collapseProducts","aria-expanded":"false","aria-controls":"collapseProducts",onClick:t[2]||(t[2]=(...e)=>ke.collapseIcon&&ke.collapseIcon(...e)),style:{padding:"0 7px"}},[(0,i.Lk)("i",{class:(0,l.C4)(Le.icon),ref:"collapseIcon"},null,2)])])]),(0,i.Lk)("div",R,[(0,i.Lk)("div",V,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.searchOrder.products,(t=>((0,i.uX)(),(0,i.CE)("div",{key:t.id,class:"row justify-content-center border-bottom py-2"},[(0,i.Lk)("p",W,(0,l.v_)(t.product.title),1),(0,i.Lk)("p",Y,"x"+(0,l.v_)(t.qty),1),(0,i.Lk)("p",G," NT$"+(0,l.v_)(e.$filters.currency(t.total)),1)])))),128)),(0,i.Lk)("div",Z,[(0,i.Lk)("div",ee,[te,(0,i.Lk)("p",null,(0,l.v_)(e.originalTotal),1)]),e.couponCode?((0,i.uX)(),(0,i.CE)("div",se,[ie,(0,i.Lk)("p",null,(0,l.v_)(e.originalTotal-e.searchOrder.total),1)])):(0,i.Q3)("",!0),e.couponCode?((0,i.uX)(),(0,i.CE)("div",oe,[le,(0,i.Lk)("p",null,(0,l.v_)(e.couponCode),1)])):(0,i.Q3)("",!0)]),re,(0,i.Lk)("div",ne,[ae,(0,i.Lk)("p",null,"NT$"+(0,l.v_)(e.$filters.currency(e.searchOrder.total)),1)])])],512),e.searchOrder.is_paid?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",ce,[de,he,ue,(0,i.Lk)("div",ge,[(0,i.Lk)("button",{class:"btn btn-secondary fw-bold",type:"button",onClick:t[3]||(t[3]=t=>e.gotoPay(e.searchOrder.id))}," 前往付款 ")])]))])])])])):e.warning?((0,i.uX)(),(0,i.CE)("div",pe,[(0,i.Lk)("p",me,(0,l.v_)(e.warning),1)])):(0,i.Q3)("",!0)])],64)}var Le=s(3497),ke=s(4445),_e=s(8647),ve=s.n(_e),be={data(){return{orderId:"",collapse:{},icon:"fa-solid fa-caret-down"}},computed:{...(0,ke.aH)(Le.A,["couponCode","searchOrder","warning","isLoading","originalTotal"])},methods:{...(0,ke.i0)(Le.A,["getOrder","gotoPay"]),sendSearchOrder(){const e=this.orderId.trim();this.getOrder(e,"search")},collapseIcon(){"fa-solid fa-caret-down"===this.$refs.collapseIcon.className?this.icon="fa-solid fa-caret-up":this.icon="fa-solid fa-caret-down"}},mounted(){const e=document.querySelector(".collapse");this.collapse=new(ve())(e),this.collapse.hide()}},ye=s(6262);const we=(0,ye.A)(be,[["render",fe]]);var Ce=we}}]);
//# sourceMappingURL=643.22860dcf.js.map