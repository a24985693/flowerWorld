"use strict";(self["webpackChunkfinal_hw"]=self["webpackChunkfinal_hw"]||[]).push([[638],{7649:function(t,e,s){s(4114);var i=s(4445),o=s(1250),a=s(9325),r=s(8465),c=s.n(r),n=s(9040);const d=(0,n.A)();e.A=(0,i.nY)("cart",{state:()=>({cart:{},cartLength:"",couponWarning:"",btnLoading:"",isLoading:!1}),actions:{getCart(){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/api/cms67/cart";o.A.get(t).then((t=>{this.isLoading=!1,this.cart=t.data.data,this.cartLength=this.cart.carts.length})).catch((()=>{this.isLoading=!1,d.pushMessage({style:"danger",title:"購物車取得失敗"})}))},updateCart(t,e){this.isLoading=!0;let s=e;s>20?s=20:s<1&&(s=1);const i=`https://vue3-course-api.hexschool.io/api/cms67/cart/${t.id}`,a={product_id:t.product_id,qty:s};o.A.put(i,{data:a}).then((()=>{this.getCart()})).catch((()=>{d.pushMessage({style:"danger",title:"數量修改失敗"})}))},addtoCart(t,e=1){let s;this.btnLoading=t.id,this.cart.carts?s=this.cart.carts.filter((e=>e.product_id===t.id)):this.getCart();const i="https://vue3-course-api.hexschool.io/api/cms67/cart",a={product_id:t.id,qty:e};o.A.post(i,{data:a}).then((t=>{this.btnLoading="";const{title:e}=t.data.data.product;if(t.data.data.qty>20){const t="已加入到最大數量";d.pushMessage({style:"warning",title:t,content:`購物車內目前已有20件${e}`}),this.updateCart(s[0],20)}else{const t="加入成功";d.pushMessage({style:"success",title:t,content:`已將${e}加入購物車`}),this.getCart()}})).catch((()=>{this.btnLoading="",d.pushMessage({style:"danger",title:"購物車加入失敗"})}))},deleteCartItem(t){this.isLoading=!0;const e=`https://vue3-course-api.hexschool.io/api/cms67/cart/${t.id}`;o.A.delete(e).then((()=>{this.getCart();const e="已移除品項";d.pushMessage({style:"danger",title:e,content:`已將${t.product.title}移除`})})).catch((()=>{this.isLoading=!1,d.pushMessage({style:"danger",title:"購物車刪除失敗"})}))},confirmDeleteAll(){c().fire({text:"確定要將清空購物車嗎",icon:"warning",cancelButtonText:"取消",confirmButtonText:"確定",showCancelButton:!0}).then((t=>{t.isConfirmed&&this.deleteAll()}))},deleteAll(){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/api/cms67/carts";o.A.delete(t).then((()=>{this.getCart();const t="已移除全部品項";d.pushMessage({style:"danger",title:t,content:"已將全部品項移除"})})).catch((()=>{this.isLoading=!1,d.pushMessage({style:"danger",title:"購物車刪除失敗"})}))},addCouponCode(t){this.isLoading=!0;const e="https://vue3-course-api.hexschool.io/api/cms67/coupon",s={code:t};o.A.post(e,{data:s}).then((t=>{t.data.success?(this.getCart(),this.couponWarning=""):(this.isLoading=!1,this.couponWarning="找不到優惠券")})).catch((()=>{this.isLoading=!1,d.pushMessage({style:"danger",title:"優惠券加入失敗"})}))},returnPage(){a.A.go(-1)},returnIndex(){a.A.push("/index")},gotoShop(){a.A.push("/productsList")}}})},5491:function(t,e,s){s(4114);var i=s(4445),o=s(8465),a=s.n(o),r=s(9040);const c=(0,r.A)();e.A=(0,i.nY)("favorite",{state:()=>({favorited:JSON.parse(localStorage.getItem("favorite"))||[]}),actions:{delFav(t){const e=[];this.favorited.forEach((t=>{e.push(t.id)})),this.favorited.splice(e.indexOf(t.id),1),localStorage.setItem("favorite",JSON.stringify(this.favorited));const s="已移除收藏";c.pushMessage({style:"danger",title:s,content:`已將${t.title}移除收藏`})},confirmClearAll(){a().fire({text:"確定要將清空收藏嗎",icon:"warning",cancelButtonText:"取消",confirmButtonText:"確定",showCancelButton:!0}).then((t=>{t.isConfirmed&&this.clearAllFav()}))},clearAllFav(){this.favorited=[],localStorage.setItem("favorite",JSON.stringify(this.favorited));const t="已移除收藏";c.pushMessage({style:"danger",title:t,content:"已將全部商品移除收藏"})},setFav(t){if(this.favorited.length){const e=[];this.favorited.forEach((t=>{e.push(t.id)})),e.includes(t.id)?this.favorited.splice(e.indexOf(t.id),1):this.favorited.push(t)}else this.favorited.push(t);localStorage.setItem("favorite",JSON.stringify(this.favorited))},favState(t){const e=[];return this.favorited.forEach((t=>{e.push(t.id)})),e.includes(t.id)?"fa-solid fa-heart":"fa-regular fa-heart"}}})},3864:function(t,e,s){s(4114);var i=s(4445),o=s(1250),a=s(9325),r=s(9040);const c=(0,r.A)();e.A=(0,i.nY)("product",{state:()=>({product:{},preferProducts:[],products:[],pagination:{},ProductsArr:[],renderProducts:[],newData:[],tempCategory:"",isLoading:!1}),actions:{getProduct(t){this.isLoading=!0;const e=`https://vue3-course-api.hexschool.io/api/cms67/product/${t}`;o.A.get(e).then((t=>{this.isLoading=!1,this.product=t.data.product})).catch((()=>{this.isLoading=!1,c.pushMessage({style:"danger",title:"商品取得失敗"})}))},getPreferProducts(){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/api/cms67/products";o.A.get(t).then((t=>{this.preferProducts=t.data.products})).catch((()=>{this.isLoading=!1,c.pushMessage({style:"danger",title:"推薦商品取得失敗"})}))},getProducts(t=1){this.isLoading=!0;const e=`https://vue3-course-api.hexschool.io/api/cms67/products?page=${t}`;o.A.get(e).then((e=>{this.products=e.data.products,this.pagination=e.data.pagination,this.pagination.category=this.tempCategory||"全部",this.products.forEach((t=>{this.ProductsArr.push(t)})),this.renderProducts=[...this.ProductsArr],this.renderCategory(t)})).catch((()=>{this.isLoading=!1,c.pushMessage({style:"danger",title:"商品取得失敗"})}))},renderCategory(t){t<this.pagination.total_pages?this.getProducts(t+1):(this.isLoading=!1,"全部"!==this.pagination.category&&(this.renderProducts=this.ProductsArr.filter((t=>t.category===this.pagination.category))),this.newData=[],this.renderProducts.forEach(((t,e)=>{e%10===0&&this.newData.push([]);const s=parseInt(e/10,10);this.newData[s].push(t)})),this.pagination.current_page=1,this.pagination.total_pages=this.newData.length,this.sortProducts=this.renderProducts,this.ProductsArr=[])},sort(t){"low"===t?this.renderProducts.sort(((t,e)=>t.price-e.price)):this.renderProducts.sort(((t,e)=>e.price-t.price)),this.ProductsArr=this.renderProducts,this.renderCategory()},updateCategory(t){this.tempCategory=t},gotoProduct(t){a.A.push(`/product/${t}`)},getPage(t){this.pagination.current_page=t,window.scrollTo(0,0)}}})},7638:function(t,e,s){s.r(e),s.d(e,{default:function(){return Y}});var i=s(641),o=s(33),a=s(3751);const r={class:"page-title"},c=(0,i.Lk)("h2",null,"我的收藏",-1),n={"aria-label":"breadcrumb"},d={class:"breadcrumb d-flex justify-content-center"},l={class:"breadcrumb-item"},h=(0,i.Lk)("li",{class:"breadcrumb-item active"}," 我的收藏 ",-1),u={key:0,class:"container"},p={class:"row justify-content-center"},g={class:"col-12 col-md-10"},f={class:"border border-2 border-info p-3 p-md-4 pt-md-5 mb-3"},v=(0,i.Fv)('<div class="row d-none d-md-flex fw-semibold pb-2"><div class="col-2"></div><div class="col-3">商品名稱</div><div class="col-3 text-center">金額</div><div class="col-4"></div></div>',1),m={class:"col-5 col-md-2"},L={class:"ratio ratio-1x1 cursor-pointer"},y=["src","onClick","onKeydown"],b={class:"col-5 col-md-9"},k={class:"row flex-column flex-md-row align-items-center gy-2"},C={class:"col col-md-4"},x={class:"col col-md-4 d-flex flex-column text-md-center"},A={key:0,class:"text-dark"},P={key:1,class:"text-dark"},w={key:2,class:"text-muted"},_={class:"col col-md-4 text-md-center"},$=["onClick","disabled"],M={class:"col-2 col-md-1 d-flex justify-content-end"},E=["onClick"],S=(0,i.Lk)("i",{class:"fa-solid fa-trash text-gray fs-4"},null,-1),F=[S],I={class:"text-end mb-2"},T={key:1,class:"text-center p-5"},X=(0,i.Lk)("i",{class:"fa-solid fa-heart text-gray fs-120 mb-5"},null,-1),D=(0,i.Lk)("h5",{class:"mb-3"},"我的收藏目前沒有商品",-1);function N(t,e,s,S,N,B){const O=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)(i.FK,null,[(0,i.Lk)("section",r,[c,(0,i.Lk)("nav",n,[(0,i.Lk)("ol",d,[(0,i.Lk)("li",l,[(0,i.bF)(O,{to:"/",class:"text-decoration-none text-light"},{default:(0,i.k6)((()=>[(0,i.eW)(" 首頁 ")])),_:1})]),h])])]),t.favorited.length?((0,i.uX)(),(0,i.CE)("div",u,[(0,i.Lk)("div",p,[(0,i.Lk)("div",g,[(0,i.Lk)("div",f,[v,((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(t.favorited,((e,s)=>((0,i.uX)(),(0,i.CE)("div",{key:e.id,class:(0,o.C4)(["row align-items-center py-3 mb-0 position-relative",{"list-border":s+1!==t.favorited.length}])},[(0,i.Lk)("div",m,[(0,i.Lk)("div",L,[(0,i.Lk)("img",{src:e.imageUrl,alt:"商品圖片",class:"object-fit-cover",onClick:s=>t.gotoProduct(e.id),onKeydown:s=>t.gotoProduct(e.id)},null,40,y)])]),(0,i.Lk)("div",b,[(0,i.Lk)("div",k,[(0,i.Lk)("div",C,[(0,i.Lk)("p",null,(0,o.v_)(e.title),1)]),(0,i.Lk)("div",x,[e.price?((0,i.uX)(),(0,i.CE)("p",A," NT$"+(0,o.v_)(t.$filters.currency(e.price)),1)):((0,i.uX)(),(0,i.CE)("p",P," NT$"+(0,o.v_)(t.$filters.currency(e.origin_price)),1)),e.origin_price!=e.price?((0,i.uX)(),(0,i.CE)("del",w," NT$"+(0,o.v_)(t.$filters.currency(e.origin_price)),1)):(0,i.Q3)("",!0)]),(0,i.Lk)("div",_,[(0,i.Lk)("button",{class:"btn btn-sm btn-info px-3",onClick:(0,a.D$)((s=>t.addtoCart(e)),["stop"]),type:"button",disabled:e.id===t.btnLoading}," 加入購物車 ",8,$)])])]),(0,i.Lk)("div",M,[(0,i.Lk)("button",{class:"btn p-1 ms-1",type:"button",onClick:s=>t.delFav(e)},F,8,E)])],2)))),128))]),(0,i.Lk)("div",I,[(0,i.Lk)("button",{class:"btn btn-sm btn-outline-gray",type:"button",onClick:e[0]||(e[0]=(...e)=>t.confirmClearAll&&t.confirmClearAll(...e))}," 清空收藏 ")])])])])):((0,i.uX)(),(0,i.CE)("div",T,[X,D,(0,i.Lk)("button",{class:"btn btn-secondary fw-semibold",onClick:e[1]||(e[1]=(...e)=>t.gotoShop&&t.gotoShop(...e))}," 繼續挑選 ")]))],64)}var B=s(3864),O=s(7649),j=s(5491),J=s(4445),K={computed:{...(0,J.aH)(O.A,["btnLoading"]),...(0,J.aH)(j.A,["favorited"])},methods:{...(0,J.i0)(B.A,["gotoProduct"]),...(0,J.i0)(O.A,["addtoCart","gotoShop"]),...(0,J.i0)(j.A,["delFav","confirmClearAll"])}},W=s(6262);const q=(0,W.A)(K,[["render",N]]);var Y=q}}]);
//# sourceMappingURL=638.205b8f44.js.map