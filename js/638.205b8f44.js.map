{"version":3,"file":"js/638.205b8f44.js","mappings":"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","sources":["webpack://final-hw/./src/stores/cartStore.js","webpack://final-hw/./src/stores/favoriteStore.js","webpack://final-hw/./src/stores/productStore.js","webpack://final-hw/./src/views/frontend/UserFavorite.vue","webpack://final-hw/./src/views/frontend/UserFavorite.vue?81d4"],"sourcesContent":["import { defineStore } from 'pinia';\nimport axios from 'axios';\nimport router from '@/router';\nimport Swal from 'sweetalert2';\nimport toastStore from './toastStore';\n\nconst toast = toastStore();\n\nexport default defineStore('cart', {\n  state: () => ({\n    cart: {},\n    cartLength: '',\n    couponWarning: '',\n    btnLoading: '',\n    isLoading: false,\n  }),\n  actions: {\n    // 取得購物車列表\n    getCart() {\n      this.isLoading = true;\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/cart`;\n\n      axios.get(url)\n        .then((res) => {\n          this.isLoading = false;\n          this.cart = res.data.data;\n          this.cartLength = this.cart.carts.length;\n        })\n        .catch(() => {\n          this.isLoading = false;\n          toast.pushMessage({\n            style: 'danger',\n            title: '購物車取得失敗',\n          });\n        });\n    },\n    // 修改購物車數量\n    updateCart(item, num) {\n      this.isLoading = true;\n      let quantity = num;\n      if (quantity > 20) { // 單品項超過20，數量就調整到20\n        quantity = 20;\n      } else if (quantity < 1) { // 單品項低於1，數量就調整到1\n        quantity = 1;\n      }\n\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/cart/${item.id}`;\n      const cart = {\n        product_id: item.product_id,\n        qty: quantity,\n      };\n\n      axios.put(url, { data: cart })\n        .then(() => {\n          this.getCart();\n        })\n        .catch(() => {\n          toast.pushMessage({\n            style: 'danger',\n            title: '數量修改失敗',\n          });\n        });\n    },\n    // 加入購物車\n    addtoCart(item, quantity = 1) {\n      this.btnLoading = item.id;\n\n      // 判斷購物車是否已有存在的商品\n      let existingProduct;\n      if (!this.cart.carts) {\n        this.getCart();\n      } else {\n        // 已有存在購物車的品項\n        existingProduct = this.cart.carts.filter((i) => i.product_id === item.id);\n      }\n\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/cart`;\n      const cart = {\n        product_id: item.id,\n        qty: quantity,\n      };\n\n      axios.post(url, { data: cart })\n        .then((res) => {\n          this.btnLoading = '';\n          const { title } = res.data.data.product;\n          // 品項數量超過20，updateCart調整品項數量為20\n          if (res.data.data.qty > 20) {\n            const messageTitle = '已加入到最大數量';\n            toast.pushMessage({\n              style: 'warning',\n              title: messageTitle,\n              content: `購物車內目前已有20件${title}`,\n            });\n            this.updateCart(existingProduct[0], 20);\n          } else {\n            const messageTitle = '加入成功';\n            toast.pushMessage({\n              style: 'success',\n              title: messageTitle,\n              content: `已將${title}加入購物車`,\n            });\n            this.getCart();\n          }\n        })\n        .catch(() => {\n          this.btnLoading = '';\n          toast.pushMessage({\n            style: 'danger',\n            title: '購物車加入失敗',\n          });\n        });\n    },\n    // 刪除單品項\n    deleteCartItem(item) {\n      this.isLoading = true;\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/cart/${item.id}`;\n\n      axios.delete(url)\n        .then(() => {\n          this.getCart();\n          const messageTitle = '已移除品項';\n          toast.pushMessage({\n            style: 'danger',\n            title: messageTitle,\n            content: `已將${item.product.title}移除`,\n          });\n        })\n        .catch(() => {\n          this.isLoading = false;\n          toast.pushMessage({\n            style: 'danger',\n            title: '購物車刪除失敗',\n          });\n        });\n    },\n    // 確認是否清空購物車\n    confirmDeleteAll() {\n      Swal.fire({\n        text: '確定要將清空購物車嗎',\n        icon: 'warning',\n        cancelButtonText: '取消',\n        confirmButtonText: '確定',\n        showCancelButton: true,\n      }).then((res) => {\n        if (res.isConfirmed) {\n          this.deleteAll();\n        }\n      });\n    },\n    // 清空購物車\n    deleteAll() {\n      this.isLoading = true;\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/carts`;\n\n      axios.delete(url)\n        .then(() => {\n          this.getCart();\n          const messageTitle = '已移除全部品項';\n          toast.pushMessage({\n            style: 'danger',\n            title: messageTitle,\n            content: '已將全部品項移除',\n          });\n        })\n        .catch(() => {\n          this.isLoading = false;\n          toast.pushMessage({\n            style: 'danger',\n            title: '購物車刪除失敗',\n          });\n        });\n    },\n    // 加入優惠券\n    addCouponCode(couponCode) {\n      this.isLoading = true;\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/coupon`;\n      const dataCode = { code: couponCode };\n\n      axios.post(url, { data: dataCode })\n        .then((res) => {\n          if (res.data.success) {\n            this.getCart();\n            this.couponWarning = '';\n          } else {\n            this.isLoading = false;\n            this.couponWarning = '找不到優惠券';\n          }\n        })\n        .catch(() => {\n          this.isLoading = false;\n          toast.pushMessage({\n            style: 'danger',\n            title: '優惠券加入失敗',\n          });\n        });\n    },\n    // 回上一頁\n    returnPage() {\n      router.go(-1);\n    },\n    // 回首頁\n    returnIndex() {\n      router.push('/index');\n    },\n    // 前往繼續購物\n    gotoShop() {\n      router.push('/productsList');\n    },\n  },\n});\n","import { defineStore } from 'pinia';\nimport Swal from 'sweetalert2';\nimport toastStore from './toastStore';\n\nconst toast = toastStore();\n\nexport default defineStore('favorite', {\n  state: () => ({\n    favorited: JSON.parse(localStorage.getItem('favorite')) || [],\n  }),\n  actions: {\n    // 移除單一收藏\n    delFav(product) {\n      const array = [];\n      this.favorited.forEach((item) => {\n        array.push(item.id);\n      });\n      this.favorited.splice(array.indexOf(product.id), 1);\n      localStorage.setItem('favorite', JSON.stringify(this.favorited));\n\n      const messageTitle = '已移除收藏';\n      toast.pushMessage({\n        style: 'danger',\n        title: messageTitle,\n        content: `已將${product.title}移除收藏`,\n      });\n    },\n    // 確認清除全部收藏\n    confirmClearAll() {\n      Swal.fire({\n        text: '確定要將清空收藏嗎',\n        icon: 'warning',\n        cancelButtonText: '取消',\n        confirmButtonText: '確定',\n        showCancelButton: true,\n      }).then((res) => {\n        if (res.isConfirmed) {\n          this.clearAllFav();\n        }\n      });\n    },\n    // 清除全部收藏\n    clearAllFav() {\n      this.favorited = [];\n      localStorage.setItem('favorite', JSON.stringify(this.favorited));\n\n      const messageTitle = '已移除收藏';\n      toast.pushMessage({\n        style: 'danger',\n        title: messageTitle,\n        content: '已將全部商品移除收藏',\n      });\n    },\n    // 加入收藏及移除收藏的切換\n    setFav(product) {\n      if (this.favorited.length) {\n        const array = [];\n        this.favorited.forEach((item) => {\n          array.push(item.id);\n        });\n        if (array.includes(product.id)) {\n          this.favorited.splice(array.indexOf(product.id), 1);\n        } else {\n          this.favorited.push(product);\n        }\n      } else {\n        this.favorited.push(product);\n      }\n      localStorage.setItem('favorite', JSON.stringify(this.favorited));\n    },\n    // 切換愛心狀態\n    favState(product) {\n      const array = [];\n      this.favorited.forEach((item) => {\n        array.push(item.id);\n      });\n\n      if (array.includes(product.id)) {\n        return 'fa-solid fa-heart';\n      }\n      return 'fa-regular fa-heart';\n    },\n  },\n});\n","import { defineStore } from 'pinia';\nimport axios from 'axios';\nimport router from '@/router';\nimport toastStore from './toastStore';\n\nconst toast = toastStore();\n\nexport default defineStore('product', {\n  state: () => ({\n    product: {},\n    preferProducts: [],\n    products: [],\n    pagination: {},\n    ProductsArr: [],\n    renderProducts: [],\n    newData: [],\n    tempCategory: '',\n    isLoading: false,\n  }),\n  actions: {\n    // 取得單一商品\n    getProduct(id) {\n      this.isLoading = true;\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/product/${id}`;\n\n      axios.get(url)\n        .then((res) => {\n          this.isLoading = false;\n          this.product = res.data.product;\n        })\n        .catch(() => {\n          this.isLoading = false;\n          toast.pushMessage({\n            style: 'danger',\n            title: '商品取得失敗',\n          });\n        });\n    },\n    // 取得推薦商品\n    getPreferProducts() {\n      this.isLoading = true;\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/products`;\n\n      axios.get(url)\n        .then((res) => {\n          this.preferProducts = res.data.products;\n        })\n        .catch(() => {\n          this.isLoading = false;\n          toast.pushMessage({\n            style: 'danger',\n            title: '推薦商品取得失敗',\n          });\n        });\n    },\n    // 取得所有商品\n    getProducts(page = 1) {\n      this.isLoading = true;\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/products?page=${page}`;\n\n      axios.get(url)\n        .then((res) => {\n          this.products = res.data.products;\n          this.pagination = res.data.pagination;\n          this.pagination.category = this.tempCategory || '全部';\n          // 取得所有商品後分類\n          this.products.forEach((item) => {\n            this.ProductsArr.push(item);\n          });\n          this.renderProducts = [...this.ProductsArr];\n          this.renderCategory(page);\n        })\n        .catch(() => {\n          this.isLoading = false;\n          toast.pushMessage({\n            style: 'danger',\n            title: '商品取得失敗',\n          });\n        });\n    },\n    // 分類商品\n    renderCategory(page) {\n      // 取得每一頁的商品後，再進行分類\n      if (page < this.pagination.total_pages) {\n        this.getProducts(page + 1);\n      } else {\n        this.isLoading = false;\n        // 將同分類的商品取出\n        if (this.pagination.category !== '全部') {\n          this.renderProducts = this.ProductsArr.filter((item) => (\n            item.category === this.pagination.category\n          ));\n        }\n        // 將商品分成每十個為一頁\n        this.newData = [];\n        this.renderProducts.forEach((item, i) => {\n          if (i % 10 === 0) {\n            this.newData.push([]);\n          }\n          const pagenum = parseInt(i / 10, 10);\n          this.newData[pagenum].push(item);\n        });\n\n        this.pagination.current_page = 1;\n        this.pagination.total_pages = this.newData.length;\n        this.sortProducts = this.renderProducts;\n        this.ProductsArr = [];\n      }\n    },\n    // 產品排序\n    sort(price) {\n      if (price === 'low') {\n        this.renderProducts.sort((a, b) => a.price - b.price);\n      } else {\n        this.renderProducts.sort((a, b) => b.price - a.price);\n      }\n      this.ProductsArr = this.renderProducts;\n      this.renderCategory();\n    },\n    updateCategory(category) {\n      this.tempCategory = category;\n    },\n    // 轉到產品頁\n    gotoProduct(id) {\n      router.push(`/product/${id}`);\n    },\n    getPage(page) {\n      this.pagination.current_page = page;\n      window.scrollTo(0, 0);\n    },\n  },\n});\n","<template>\n  <section class=\"page-title\">\n    <h2>我的收藏</h2>\n    <nav aria-label=\"breadcrumb\">\n      <ol class=\"breadcrumb d-flex justify-content-center\">\n        <li class=\"breadcrumb-item\">\n          <router-link to=\"/\" class=\"text-decoration-none text-light\">\n            首頁\n          </router-link>\n        </li>\n        <li class=\"breadcrumb-item active\">\n          我的收藏\n        </li>\n      </ol>\n    </nav>\n  </section>\n  <div class=\"container\" v-if=\"favorited.length\">\n    <div class=\"row justify-content-center\">\n      <div class=\"col-12 col-md-10\">\n        <div class=\"border border-2 border-info p-3 p-md-4 pt-md-5 mb-3\">\n          <div class=\"row d-none d-md-flex fw-semibold pb-2\">\n            <div class=\"col-2\"></div>\n            <div class=\"col-3\">商品名稱</div>\n            <div class=\"col-3 text-center\">金額</div>\n            <div class=\"col-4\"></div>\n          </div>\n          <div v-for=\"(item, i) in favorited\" :key=\"item.id\"\n            class=\"row align-items-center py-3 mb-0 position-relative\"\n            :class=\"{'list-border': i+1 !== favorited.length}\">\n            <div class=\"col-5 col-md-2\">\n              <div class=\"ratio ratio-1x1 cursor-pointer\">\n                <img :src=\"item.imageUrl\" alt=\"商品圖片\"\n                  class=\"object-fit-cover\"\n                  @click=\"gotoProduct(item.id)\"\n                  @keydown=\"gotoProduct(item.id)\">\n              </div>\n            </div>\n            <div class=\"col-5 col-md-9\">\n              <div class=\"row flex-column flex-md-row\n                align-items-center gy-2\">\n                <div class=\"col col-md-4\">\n                  <p>{{ item.title }}</p>\n                </div>\n                <div class=\"col col-md-4 d-flex flex-column text-md-center\">\n                  <p class=\"text-dark\" v-if=\"item.price\">\n                    NT${{ $filters.currency(item.price) }}\n                  </p>\n                  <p class=\"text-dark\" v-else>\n                    NT${{ $filters.currency(item.origin_price) }}\n                  </p>\n                  <del class=\"text-muted\" v-if=\"item.origin_price != item.price\">\n                    NT${{ $filters.currency(item.origin_price) }}\n                  </del>\n                </div>\n                <div class=\"col col-md-4 text-md-center\">\n                  <button class=\"btn btn-sm btn-info px-3\"\n                    @click.stop=\"addtoCart(item)\" type=\"button\"\n                    :disabled=\"item.id === btnLoading\">\n                    加入購物車\n                  </button>\n                </div>\n              </div>\n            </div>\n            <div class=\"col-2 col-md-1 d-flex justify-content-end\">\n              <button class=\"btn p-1 ms-1\" type=\"button\"\n                @click=\"delFav(item)\">\n                <i class=\"fa-solid fa-trash text-gray fs-4\"/>\n              </button>\n            </div>\n          </div>\n        </div>\n        <div class=\"text-end mb-2\">\n          <button class=\"btn btn-sm btn-outline-gray\" type=\"button\"\n            @click=\"confirmClearAll\">\n            清空收藏\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div class=\"text-center p-5\" v-else>\n    <i class=\"fa-solid fa-heart text-gray fs-120 mb-5\"/>\n    <h5 class=\"mb-3\">我的收藏目前沒有商品</h5>\n    <button class=\"btn btn-secondary fw-semibold\" @click=\"gotoShop\">\n      繼續挑選\n    </button>\n  </div>\n</template>\n\n<script>\nimport productStore from '@/stores/productStore';\nimport cartStore from '@/stores/cartStore';\nimport favoriteStore from '@/stores/favoriteStore';\nimport { mapState, mapActions } from 'pinia';\n\nexport default {\n  computed: {\n    ...mapState(cartStore, ['btnLoading']),\n    ...mapState(favoriteStore, ['favorited']),\n  },\n  methods: {\n    ...mapActions(productStore, ['gotoProduct']),\n    ...mapActions(cartStore, ['addtoCart', 'gotoShop']),\n    ...mapActions(favoriteStore, ['delFav', 'confirmClearAll']),\n  },\n};\n</script>\n","import { render } from \"./UserFavorite.vue?vue&type=template&id=47efcb7e\"\nimport script from \"./UserFavorite.vue?vue&type=script&lang=js\"\nexport * from \"./UserFavorite.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["toast","toastStore","defineStore","state","cart","cartLength","couponWarning","btnLoading","isLoading","actions","getCart","this","url","axios","get","then","res","data","carts","length","catch","pushMessage","style","title","updateCart","item","num","quantity","id","product_id","qty","put","addtoCart","existingProduct","filter","i","post","product","messageTitle","content","deleteCartItem","delete","confirmDeleteAll","Swal","text","icon","cancelButtonText","confirmButtonText","showCancelButton","isConfirmed","deleteAll","addCouponCode","couponCode","dataCode","code","success","returnPage","router","go","returnIndex","push","gotoShop","favorited","JSON","parse","localStorage","getItem","delFav","array","forEach","splice","indexOf","setItem","stringify","confirmClearAll","clearAllFav","setFav","includes","favState","preferProducts","products","pagination","ProductsArr","renderProducts","newData","tempCategory","getProduct","getPreferProducts","getProducts","page","category","renderCategory","total_pages","pagenum","parseInt","current_page","sortProducts","sort","price","a","b","updateCategory","gotoProduct","getPage","window","scrollTo","class","_createElementVNode","key","_createStaticVNode","_hoisted_26","_createElementBlock","_Fragment","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_createVNode","_component_router_link","to","default","_withCtx","_createTextVNode","_","_hoisted_6","_ctx","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_renderList","_normalizeClass","_hoisted_12","_hoisted_13","src","imageUrl","alt","onClick","$event","onKeydown","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_toDisplayString","_hoisted_18","_hoisted_19","$filters","currency","_hoisted_20","origin_price","_hoisted_21","_createCommentVNode","_hoisted_22","_withModifiers","type","disabled","_hoisted_23","_hoisted_24","_hoisted_27","_hoisted_25","_hoisted_28","_cache","args","_hoisted_29","_hoisted_30","_hoisted_31","computed","mapState","cartStore","favoriteStore","methods","mapActions","productStore","__exports__","render"],"sourceRoot":""}