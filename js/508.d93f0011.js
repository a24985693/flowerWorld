"use strict";(self["webpackChunkfinal_hw"]=self["webpackChunkfinal_hw"]||[]).push([[508],{7649:function(t,e,s){s(4114);var o=s(4445),a=s(1250),i=s(9325),n=s(8465),c=s.n(n),l=s(9040);const r=(0,l.A)();e.A=(0,o.nY)("cart",{state:()=>({cart:{},cartLength:"",couponWarning:"",btnLoading:"",isLoading:!1}),actions:{getCart(){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/api/cms67/cart";a.A.get(t).then((t=>{this.isLoading=!1,this.cart=t.data.data,this.cartLength=this.cart.carts.length})).catch((()=>{this.isLoading=!1,r.pushMessage({style:"danger",title:"購物車取得失敗"})}))},updateCart(t,e){this.isLoading=!0;let s=e;s>20?s=20:s<1&&(s=1);const o=`https://vue3-course-api.hexschool.io/api/cms67/cart/${t.id}`,i={product_id:t.product_id,qty:s};a.A.put(o,{data:i}).then((()=>{this.getCart()})).catch((()=>{r.pushMessage({style:"danger",title:"數量修改失敗"})}))},addtoCart(t,e=1){let s;this.btnLoading=t.id,this.cart.carts?s=this.cart.carts.filter((e=>e.product_id===t.id)):this.getCart();const o="https://vue3-course-api.hexschool.io/api/cms67/cart",i={product_id:t.id,qty:e};a.A.post(o,{data:i}).then((t=>{this.btnLoading="";const{title:e}=t.data.data.product;if(t.data.data.qty>20){const t="已加入到最大數量";r.pushMessage({style:"warning",title:t,content:`購物車內目前已有20件${e}`}),this.updateCart(s[0],20)}else{const t="加入成功";r.pushMessage({style:"success",title:t,content:`已將${e}加入購物車`}),this.getCart()}})).catch((()=>{this.btnLoading="",r.pushMessage({style:"danger",title:"購物車加入失敗"})}))},deleteCartItem(t){this.isLoading=!0;const e=`https://vue3-course-api.hexschool.io/api/cms67/cart/${t.id}`;a.A.delete(e).then((()=>{this.getCart();const e="已移除品項";r.pushMessage({style:"danger",title:e,content:`已將${t.product.title}移除`})})).catch((()=>{this.isLoading=!1,r.pushMessage({style:"danger",title:"購物車刪除失敗"})}))},confirmDeleteAll(){c().fire({text:"確定要將清空購物車嗎",icon:"warning",cancelButtonText:"取消",confirmButtonText:"確定",showCancelButton:!0}).then((t=>{t.isConfirmed&&this.deleteAll()}))},deleteAll(){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/api/cms67/carts";a.A.delete(t).then((()=>{this.getCart();const t="已移除全部品項";r.pushMessage({style:"danger",title:t,content:"已將全部品項移除"})})).catch((()=>{this.isLoading=!1,r.pushMessage({style:"danger",title:"購物車刪除失敗"})}))},addCouponCode(t){this.isLoading=!0;const e="https://vue3-course-api.hexschool.io/api/cms67/coupon",s={code:t};a.A.post(e,{data:s}).then((t=>{t.data.success?(this.getCart(),this.couponWarning=""):(this.isLoading=!1,this.couponWarning="找不到優惠券")})).catch((()=>{this.isLoading=!1,r.pushMessage({style:"danger",title:"優惠券加入失敗"})}))},returnPage(){i.A.go(-1)},returnIndex(){i.A.push("/index")},gotoShop(){i.A.push("/productsList")}}})},3864:function(t,e,s){s(4114);var o=s(4445),a=s(1250),i=s(9325),n=s(9040);const c=(0,n.A)();e.A=(0,o.nY)("product",{state:()=>({product:{},preferProducts:[],products:[],pagination:{},ProductsArr:[],renderProducts:[],newData:[],tempCategory:"",isLoading:!1}),actions:{getProduct(t){this.isLoading=!0;const e=`https://vue3-course-api.hexschool.io/api/cms67/product/${t}`;a.A.get(e).then((t=>{this.isLoading=!1,this.product=t.data.product})).catch((()=>{this.isLoading=!1,c.pushMessage({style:"danger",title:"商品取得失敗"})}))},getPreferProducts(){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/api/cms67/products";a.A.get(t).then((t=>{this.preferProducts=t.data.products})).catch((()=>{this.isLoading=!1,c.pushMessage({style:"danger",title:"推薦商品取得失敗"})}))},getProducts(t=1){this.isLoading=!0;const e=`https://vue3-course-api.hexschool.io/api/cms67/products?page=${t}`;a.A.get(e).then((e=>{this.products=e.data.products,this.pagination=e.data.pagination,this.pagination.category=this.tempCategory||"全部",this.products.forEach((t=>{this.ProductsArr.push(t)})),this.renderProducts=[...this.ProductsArr],this.renderCategory(t)})).catch((()=>{this.isLoading=!1,c.pushMessage({style:"danger",title:"商品取得失敗"})}))},renderCategory(t){t<this.pagination.total_pages?this.getProducts(t+1):(this.isLoading=!1,"全部"!==this.pagination.category&&(this.renderProducts=this.ProductsArr.filter((t=>t.category===this.pagination.category))),this.newData=[],this.renderProducts.forEach(((t,e)=>{e%10===0&&this.newData.push([]);const s=parseInt(e/10,10);this.newData[s].push(t)})),this.pagination.current_page=1,this.pagination.total_pages=this.newData.length,this.sortProducts=this.renderProducts,this.ProductsArr=[])},sort(t){"low"===t?this.renderProducts.sort(((t,e)=>t.price-e.price)):this.renderProducts.sort(((t,e)=>e.price-t.price)),this.ProductsArr=this.renderProducts,this.renderCategory()},updateCategory(t){this.tempCategory=t},gotoProduct(t){i.A.push(`/product/${t}`)},getPage(t){this.pagination.current_page=t,window.scrollTo(0,0)}}})},3508:function(t,e,s){s.r(e),s.d(e,{default:function(){return ft}});var o=s(641),a=s(33),i=s(3751);const n={class:"page-title"},c=(0,o.Lk)("h2",null,"購物車",-1),l={"aria-label":"breadcrumb"},r={class:"breadcrumb d-flex justify-content-center"},d={class:"breadcrumb-item"},u=(0,o.Lk)("li",{class:"breadcrumb-item active"}," 購物車 ",-1),p={class:"container"},h=(0,o.Fv)('<div class="row justify-content-center text-center mb-5"><div class="col-4 col-md-3"><div class="pay-step bg-info text-white"><span>1</span></div><span>確認訂單</span></div><div class="col-4 col-md-3"><div class="pay-step border"><span>2</span></div><span>填寫資料</span></div><div class="col-4 col-md-3"><div class="pay-step border"><span>3</span></div><span>付款</span></div></div>',1),g={key:0,class:"row"},L={class:"col-12"},v={class:"row mt-3"},k={class:"col-12 col-lg-8"},m={class:"mb-3 px-3"},b=(0,o.Fv)('<div class="row d-none d-md-flex fw-semibold py-3"><div class="col-2"></div><div class="col-9"><div class="row"><div class="col-5">商品名稱</div><div class="col-4 text-center">數量</div><div class="col-3 text-end">金額</div></div></div><div class="col-1"></div></div>',1),f={class:"col-5 col-md-2"},y={class:"ratio ratio-1x1 cursor-pointer"},C=["src","onClick","onKeydown"],x={class:"col-5 col-md-9"},w={class:"row flex-column flex-md-row align-items-center gy-3"},A={class:"col-12 col-md-5"},P={class:"col-12 col-md-4 update-num align-items-center justify-content-center"},_={class:"input-group border"},$=(0,o.Lk)("label",{for:"number",class:"d-none"},null,-1),M=["onClick","disabled"],q=(0,o.Lk)("i",{class:"fa-solid fa-minus"},null,-1),E=[q],j=["onUpdate:modelValue","onChange"],D=["onClick","disabled"],W=(0,o.Lk)("i",{class:"fa-solid fa-plus"},null,-1),X=[W],F={class:"col-12 col-md-3 text-md-end"},I={class:"col-2 col-md-1"},T={class:"delete-icon text-end"},S=["onClick"],K=(0,o.Lk)("i",{class:"fa-solid fa-trash text-gray fs-5"},null,-1),U=[K],B={class:"row justify-content-between mb-4"},N={class:"col"},Q={class:"col text-end"},V={class:"col-12 col-lg-4"},J={class:"border border-2 border-info"},Y=(0,o.Lk)("div",{class:"w-100 bg-info text-white fs-5 text-center py-2"}," 總計 ",-1),H={class:"py-4 px-3"},z={class:"mb-5"},G={class:"text-end d-flex justify-content-between mb-1"},O=(0,o.Lk)("p",null,"小計",-1),R={key:0,class:"text-end d-flex justify-content-between text-muted mb-1"},Z=(0,o.Lk)("p",null,"折扣",-1),tt={key:1,class:"text-end d-flex justify-content-between text-muted"},et=(0,o.Lk)("p",null,"已套用優惠券",-1),st=(0,o.Lk)("label",{for:"coupon",class:"d-none"},null,-1),ot={class:"input-group mt-3 mb-1"},at={key:0,class:"text-danger"},it=(0,o.Lk)("hr",null,null,-1),nt={class:"text-end d-flex justify-content-between fs-5 fw-semibold mb-3"},ct=(0,o.Lk)("p",null,"總計",-1),lt={class:"text-end"},rt=(0,o.Lk)("i",{class:"fa-solid fa-angle-right"},null,-1),dt={key:1,class:"text-center p-5"},ut=(0,o.Lk)("i",{class:"fa-solid fa-cart-shopping text-gray fs-120 mb-5"},null,-1),pt=(0,o.Lk)("h5",{class:"mb-3"},"購物車目前沒有商品",-1);function ht(t,e,s,q,W,K){const ht=(0,o.g2)("LoadingSpinner"),gt=(0,o.g2)("router-link");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(ht,{active:t.isLoading},null,8,["active"]),(0,o.Lk)("section",n,[c,(0,o.Lk)("nav",l,[(0,o.Lk)("ol",r,[(0,o.Lk)("li",d,[(0,o.bF)(gt,{to:"/",class:"text-decoration-none text-light"},{default:(0,o.k6)((()=>[(0,o.eW)(" 首頁 ")])),_:1})]),u])])]),(0,o.Lk)("div",p,[h,0!==t.cartLength?((0,o.uX)(),(0,o.CE)("div",g,[(0,o.Lk)("div",L,[(0,o.Lk)("div",v,[(0,o.Lk)("div",k,[(0,o.Lk)("div",m,[b,((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(t.cart.carts,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:"row align-items-center border-bottom border-dark py-3 mb-0"},[(0,o.Lk)("div",f,[(0,o.Lk)("div",y,[(0,o.Lk)("img",{src:e.product.imageUrl,alt:"商品圖片",class:"object-fit-cover",onClick:s=>t.gotoProduct(e.product.id),onKeydown:s=>t.gotoProduct(e.product.id)},null,40,C)])]),(0,o.Lk)("div",x,[(0,o.Lk)("div",w,[(0,o.Lk)("div",A,[(0,o.Lk)("p",null,(0,a.v_)(e.product.title),1)]),(0,o.Lk)("div",P,[(0,o.Lk)("div",_,[$,(0,o.Lk)("button",{type:"button",class:"btn px-2 py-1",onClick:s=>t.updateCart(e,e.qty-1),disabled:e.qty<=1},E,8,M),(0,o.bo)((0,o.Lk)("input",{type:"number",class:"shadow-none form-control text-center","onUpdate:modelValue":t=>e.qty=t,id:"number",min:"1",max:"100",onChange:s=>t.updateCart(e,e.qty)},null,40,j),[[i.Jo,e.qty]]),(0,o.Lk)("button",{type:"button",class:"btn px-2 py-1",onClick:s=>{t.updateCart(e,e.qty+1)},disabled:e.qty>=20},X,8,D)])]),(0,o.Lk)("div",F," NT$"+(0,a.v_)(t.$filters.currency(e.total)),1)])]),(0,o.Lk)("div",I,[(0,o.Lk)("div",T,[(0,o.Lk)("button",{class:"btn px-0",type:"button",onClick:s=>t.deleteCartItem(e)},U,8,S)])])])))),128))]),(0,o.Lk)("div",B,[(0,o.Lk)("div",N,[(0,o.Lk)("span",null,"共 "+(0,a.v_)(t.cartLength)+" 件商品",1)]),(0,o.Lk)("div",Q,[(0,o.Lk)("button",{class:"btn btn-sm btn-outline-gray",type:"button",onClick:e[0]||(e[0]=(...e)=>t.confirmDeleteAll&&t.confirmDeleteAll(...e))}," 清空購物車 ")])])]),(0,o.Lk)("div",V,[(0,o.Lk)("div",J,[Y,(0,o.Lk)("div",H,[(0,o.Lk)("div",z,[(0,o.Lk)("div",G,[O,(0,o.Lk)("p",null,"NT$"+(0,a.v_)(t.$filters.currency(t.cart.total)),1)]),t.cart.final_total!==t.cart.total?((0,o.uX)(),(0,o.CE)("div",R,[Z,(0,o.Lk)("p",null,(0,a.v_)(t.$filters.currency(t.cart.total-t.cart.final_total)),1)])):(0,o.Q3)("",!0),t.cart.final_total!==t.cart.total?((0,o.uX)(),(0,o.CE)("div",tt,[et,(0,o.Lk)("p",null,(0,a.v_)(t.cart.carts[0].coupon.code),1)])):(0,o.Q3)("",!0),(0,o.Lk)("div",null,[st,(0,o.Lk)("div",ot,[(0,o.bo)((0,o.Lk)("input",{type:"text",class:"form-control rounded-0",placeholder:"請輸入優惠碼","onUpdate:modelValue":e[1]||(e[1]=t=>W.tempCouponCode=t),id:"coupon"},null,512),[[i.Jo,W.tempCouponCode]]),(0,o.Lk)("button",{class:"btn btn-info",onClick:e[2]||(e[2]=(...t)=>K.sendCouponCode&&K.sendCouponCode(...t))},"套用")]),t.couponWarning?((0,o.uX)(),(0,o.CE)("span",at," *"+(0,a.v_)(t.couponWarning),1)):(0,o.Q3)("",!0)])]),it,(0,o.Lk)("li",nt,[ct,(0,o.Lk)("p",null,"NT$"+(0,a.v_)(t.$filters.currency(t.cart.final_total)),1)]),(0,o.Lk)("div",lt,[(0,o.bF)(gt,{to:"/information",class:"btn btn-secondary w-100 fw-bold"},{default:(0,o.k6)((()=>[(0,o.eW)(" 下一步 "),rt])),_:1})])])])])])])])):((0,o.uX)(),(0,o.CE)("div",dt,[ut,pt,(0,o.Lk)("button",{class:"btn btn-secondary fw-semibold",onClick:e[3]||(e[3]=(...e)=>t.gotoShop&&t.gotoShop(...e))}," 繼續購物 ")]))])],64)}var gt=s(3864),Lt=s(7649),vt=s(4445),kt={data(){return{tempCouponCode:""}},computed:{...(0,vt.aH)(Lt.A,["cart","cartLength","couponWarning","isLoading"])},methods:{...(0,vt.i0)(gt.A,["gotoProduct"]),...(0,vt.i0)(Lt.A,["getCart","updateCart","deleteCartItem","confirmDeleteAll","addCouponCode","returnPage","gotoShop"]),sendCouponCode(){this.addCouponCode(this.tempCouponCode),this.tempCouponCode=""}},created(){this.getCart()}},mt=s(6262);const bt=(0,mt.A)(kt,[["render",ht]]);var ft=bt}}]);
//# sourceMappingURL=508.d93f0011.js.map