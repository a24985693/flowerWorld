{"version":3,"file":"js/578.71c2ba0e.js","mappings":"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","sources":["webpack://final-hw/./src/views/backend/OrderList.vue","webpack://final-hw/./src/components/backend/OrderModal.vue","webpack://final-hw/./src/stores/adminOrderStore.js","webpack://final-hw/./src/components/backend/OrderModal.vue?c028","webpack://final-hw/./src/views/backend/OrderList.vue?3218"],"sourcesContent":["<template>\n  <LoadingSpinner :active=\"isLoading\"/>\n  <div class=\"table-responsive\">\n    <table class=\"table text-nowrap\">\n      <thead>\n        <tr>\n          <th scope=\"col\">訂單編號</th>\n          <th scope=\"col\">Email</th>\n          <th scope=\"col\">購買項目</th>\n          <th scope=\"col\">應付金額</th>\n          <th scope=\"col\">是否付款</th>\n          <th scope=\"col\">編輯</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr v-for=\"item in orders\" :key=\"item.id\">\n          <td scope=\"row\">{{ item.create_at }}</td>\n          <td>{{ item.user.email }}</td>\n          <td>\n            <ul class=\"list-unstyled\">\n              <li v-for=\"(product, key) in item.products\" :key=\"key\">\n                品名:{{ product.product.title }} 數量:{{ product.product.num }}\n              </li>\n            </ul>\n          </td>\n          <td>{{ $filters.currency(item.total) }}</td>\n          <td>\n            <span v-if=\"item.is_paid\" class=\"text-success\">已付款</span>\n            <span v-else class=\"text-muted\">未付款</span>\n          </td>\n          <td>\n            <div class=\"btn-group\">\n              <button class=\"btn btn-outline-gray btn-sm\" type=\"button\"\n                @click=\"openModal(item)\">編輯</button>\n              <button class=\"btn btn-outline-danger btn-sm\" type=\"button\"\n                @click=\"comfirmDelOrder(item)\">刪除</button>\n            </div>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n  </div>\n  <OrderModal ref=\"OrderModal\"/>\n  <PageNavigation :pagination=\"pagination\"\n    @update-page=\"getOrders\"/>\n</template>\n\n<script>\nimport OrderModal from '@/components/backend/OrderModal.vue';\nimport PageNavigation from '@/components/PageNavigation.vue';\nimport adminOrderStore from '@/stores/adminOrderStore';\nimport { mapState, mapActions } from 'pinia';\n\nexport default {\n  components: {\n    OrderModal,\n    PageNavigation,\n  },\n  computed: {\n    ...mapState(adminOrderStore, [\n      'orders',\n      'pagination',\n      'isLoading',\n    ]),\n  },\n  methods: {\n    ...mapActions(adminOrderStore, [\n      'getOrders',\n      'getOrder',\n      'comfirmDelOrder',\n    ]),\n    openModal(item) {\n      this.getOrder(item);\n      this.$refs.OrderModal.showModal();\n    },\n  },\n  created() {\n    this.getOrders();\n  },\n};\n</script>\n","<template>\n  <div class=\"modal fade\" id=\"exampleModal\" tabindex=\"-1\"\n    aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\"\n    ref=\"modal\">\n    <div class=\"modal-dialog\" role=\"document\">\n      <div class=\"modal-content border-0\">\n        <div class=\"modal-header bg-dark text-white\">\n          <h5 class=\"modal-title\" id=\"exampleModalLabel\">編輯訂單</h5>\n          <button type=\"button\" class=\"btn-close text-white\"\n            data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n        </div>\n        <div class=\"modal-body\">\n          <div class=\"modal-body\">\n            <div class=\"mb-3\">\n              <label for=\"total\">請輸入金額</label>\n              <input type=\"number\" class=\"form-control\" id=\"total\"\n                v-model=\"order.total\">\n            </div>\n            <div class=\"mb-3\">\n              <input type=\"checkbox\" class=\"form-check-input\" id=\"is_paid\"\n                v-model=\"order.is_paid\">\n              <label for=\"is_paid\">是否付款</label>\n            </div>\n          </div>\n        </div>\n        <div class=\"modal-footer\">\n          <button type=\"button\" class=\"btn btn-gray\" data-bs-dismiss=\"modal\">取消</button>\n          <button type=\"button\" class=\"btn btn-secondary\"\n            @click=\"sendUpdateOrder\">確認</button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport modalMixin from '@/mixins/modalMixin';\nimport adminOrderStore from '@/stores/adminOrderStore';\nimport { mapState, mapActions } from 'pinia';\n\nexport default {\n  mixins: [modalMixin],\n  watch: {\n    tempOrder() {\n      this.order = this.tempOrder;\n    },\n  },\n  data() {\n    return {\n      order: {},\n    };\n  },\n  computed: {\n    ...mapState(adminOrderStore, ['tempOrder']),\n  },\n  methods: {\n    ...mapActions(adminOrderStore, ['updateOrder']),\n    sendUpdateOrder() {\n      this.updateOrder(this.order);\n      this.hideModal();\n    },\n  },\n};\n</script>\n","import { defineStore } from 'pinia';\nimport axios from 'axios';\nimport Swal from 'sweetalert2';\nimport toastStore from './toastStore';\n\nconst toast = toastStore();\n\nexport default defineStore('adminOrder', {\n  state: () => ({\n    orders: {},\n    tempOrder: {},\n    pagination: {},\n    isLoading: false,\n  }),\n  actions: {\n    // 取得訂單列表\n    getOrders(page = 1) {\n      this.isLoading = true;\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/orders?page=${page}`;\n\n      axios.get(url)\n        .then((res) => {\n          this.isLoading = false;\n          this.orders = res.data.orders;\n          this.pagination = res.data.pagination;\n        })\n        .catch(() => {\n          this.isLoading = false;\n          toast.pushMessage({\n            style: 'danger',\n            title: '訂單列表取得失敗',\n            content: '請稍後嘗試',\n          });\n        });\n    },\n    // 取得單一訂單\n    getOrder(item) {\n      this.tempOrder = { ...item };\n    },\n    // 編輯訂單\n    updateOrder(item) {\n      // 訂單金額需大於0\n      if (item.total > 0) {\n        this.isLoading = true;\n        this.tempOrder = item;\n        const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/order/${item.id}`;\n\n        axios.put(url, { data: this.tempOrder })\n          .then((res) => {\n            let messageTitle = '更新成功';\n            if (res.data.success) {\n              this.getOrders();\n              toast.pushMessage({\n                style: 'success',\n                title: messageTitle,\n              });\n            } else {\n              this.isLoading = false;\n              messageTitle = '更新失敗';\n              toast.pushMessage({\n                style: 'danger',\n                title: messageTitle,\n                content: res.data.message.join('、'),\n              });\n            }\n          })\n          .catch(() => {\n            this.isLoading = false;\n            toast.pushMessage({\n              style: 'danger',\n              title: '更新失敗',\n              content: '請稍後嘗試',\n            });\n          });\n      } else {\n        this.isLoading = false;\n        toast.pushMessage({\n          style: 'danger',\n          title: '金額不正確，請重新輸入',\n        });\n      }\n    },\n    // 確認刪除訂單\n    comfirmDelOrder(item) {\n      Swal.fire({\n        title: '確定刪除嗎',\n        text: `確定要${item.paid_date}刪除嗎`,\n        icon: 'warning',\n        cancelButtonText: '取消',\n        confirmButtonText: '確定',\n        showCancelButton: true,\n      }).then((res) => {\n        if (res.isConfirmed) {\n          this.deleteOrder(item);\n        }\n      });\n    },\n    // 刪除訂單\n    deleteOrder(item) {\n      this.isLoading = true;\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/order/${item.id}`;\n\n      axios.delete(url)\n        .then((res) => {\n          this.getOrders();\n          if (res.data.success) {\n            toast.pushMessage({\n              style: 'success',\n              title: '刪除成功',\n            });\n          } else {\n            this.isLoading = false;\n            toast.pushMessage({\n              style: 'danger',\n              title: '刪除失敗',\n              content: res.data.message.join('、'),\n            });\n          }\n        })\n        .catch(() => {\n          this.isLoading = false;\n          toast.pushMessage({\n            style: 'danger',\n            title: '刪除失敗',\n            content: '請稍後嘗試',\n          });\n        });\n    },\n  },\n});\n","import { render } from \"./OrderModal.vue?vue&type=template&id=06309e2c\"\nimport script from \"./OrderModal.vue?vue&type=script&lang=js\"\nexport * from \"./OrderModal.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./OrderList.vue?vue&type=template&id=1b2184d4\"\nimport script from \"./OrderList.vue?vue&type=script&lang=js\"\nexport * from \"./OrderList.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","_createElementVNode","scope","key","_createElementBlock","_Fragment","_createVNode","_component_LoadingSpinner","active","_ctx","isLoading","_hoisted_1","_hoisted_2","_hoisted_3","_renderList","orders","item","id","_hoisted_4","_toDisplayString","create_at","user","email","_hoisted_5","products","product","title","num","$filters","currency","total","is_paid","_hoisted_6","_hoisted_7","_hoisted_8","type","onClick","$event","$options","openModal","_hoisted_9","comfirmDelOrder","_hoisted_10","_component_OrderModal","ref","_component_PageNavigation","pagination","onUpdatePage","getOrders","tabindex","role","for","_cache","$data","order","_hoisted_11","_hoisted_12","args","sendUpdateOrder","toast","toastStore","defineStore","state","tempOrder","actions","page","this","url","axios","get","then","res","data","catch","pushMessage","style","content","getOrder","updateOrder","put","messageTitle","success","message","join","Swal","text","paid_date","icon","cancelButtonText","confirmButtonText","showCancelButton","isConfirmed","deleteOrder","delete","mixins","modalMixin","watch","computed","mapState","adminOrderStore","methods","mapActions","hideModal","__exports__","components","OrderModal","PageNavigation","$refs","showModal","created","render"],"sourceRoot":""}